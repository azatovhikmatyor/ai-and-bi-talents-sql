select *from (	SELECT 		HireYear,		NextYear,		IntervalYear,-- 		CASE 			WHEN IntervalYear < 2 OR HireYear < 1975 THEN NULL			WHEN IntervalYear >= 2 AND NextYear IS NOT NULL THEN CONCAT(CAST(HireYear + 1 AS NVARCHAR), ' - ', CAST(NextYear - 1 AS NVARCHAR))			WHEN NextYear IS NULL THEN CONCAT(CAST(HireYear + 1 AS NVARCHAR), ' - ', year(getdate()))		END AS Years	FROM (		SELECT 			CAST(YEAR(HIRE_DATE) AS INT) AS HireYear,			LEAD(CAST(YEAR(HIRE_DATE) AS INT)) OVER(ORDER BY HIRE_DATE) AS NextYear,			LEAD(CAST(YEAR(HIRE_DATE) AS INT)) OVER(ORDER BY HIRE_DATE) - CAST(YEAR(HIRE_DATE) AS INT) AS IntervalYear		FROM EMPLOYEES_N	) AS t) as t2WHERE Years IS NOT NULLORDER BY HireYear;